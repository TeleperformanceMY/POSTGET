<!DOCTYPE html>
<html>
<head>
  <title>Check Application Status</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    input, button { padding: 10px; margin: 5px; width: 250px; }
    #result { margin-top: 20px; }
    .entry { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <h2>Check Your Application</h2>
  
  <input type="email" id="email" placeholder="Enter your email" required><br>
  <input type="text" id="phone" placeholder="Enter your phone number" required><br>
  <button onclick="submitApplication()">Check Status</button>

  <div id="result"></div>

  <script>
    async function submitApplication() {
      const email = document.getElementById("email").value.trim();
      const phone = document.getElementById("phone").value.trim();

      const response = await fetch("https://prod-77.southeastasia.logic.azure.com:443/workflows/3dcf20be6af641a4b49eb48727473a47/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uVigg-lTLRaUgLgUdGUnqCt9-TWJC7E7c8ryTjLC0Hw", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, phone })
      });

      const data = await response.json();

      // data.body is a JSON string of an array, so parse it!
      const resultsArray = JSON.parse(data.body);

      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = ""; // clear previous results

      if (resultsArray.length > 0) {
        resultsArray.forEach(entry => {
          const entryDiv = document.createElement("div");
          entryDiv.className = "entry";
          entryDiv.innerHTML = `
            <p><strong>Name:</strong> ${entry.name}</p>
            <p><strong>Phone:</strong> ${entry.phone}</p>
            <p><strong>Email:</strong> ${entry.email}</p>
            <p><strong>Status:</strong> ${entry.status ?? 'N/A'}</p>
            <p><strong>Referral:</strong> ${entry.referral ?? 'N/A'}</p>
          `;
          resultDiv.appendChild(entryDiv);
        });
      } else {
        resultDiv.innerHTML = `<p style="color:red;">No application found.</p>`;
      }
    }
  </script>
</body>
</html>
